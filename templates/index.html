<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QC Tool - Data Quality Check</title>
    <meta name="description" content="Quality Check Tool for validating data from multiple sources">
    <link rel="stylesheet" href="/static/css/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-brand">
            <div class="logo">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 12l2 2 4-4"></path>
                    <circle cx="12" cy="12" r="10"></circle>
                </svg>
            </div>
            <h1>QC Tool</h1>
        </div>
        <nav class="header-nav">
            <button class="nav-btn active" data-view="data">Data Source</button>
            <button class="nav-btn" data-view="qc">QC Checks</button>
            <button class="nav-btn" data-view="compare">Compare</button>
            <button class="nav-btn" data-view="results">Results</button>
        </nav>
        <div class="header-actions">
            <button id="exportBtn" class="btn btn-outline" disabled>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                Export
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Data Source View -->
        <section id="dataView" class="view active">
            <div class="view-header">
                <h2>Load Data</h2>
                <p>Select a data source and load your data for quality checks</p>
            </div>

            <!-- Source Selector -->
            <div class="source-selector">
                <button class="source-btn active" data-source="file">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M13 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V9z"></path>
                        <polyline points="13 2 13 9 20 9"></polyline>
                    </svg>
                    File Upload
                </button>
                <button class="source-btn" data-source="postgres">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
                        <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path>
                        <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>
                    </svg>
                    PostgreSQL
                </button>
                <button class="source-btn" data-source="athena">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z">
                        </path>
                    </svg>
                    AWS Athena
                </button>
            </div>

            <!-- File Upload Panel -->
            <div id="filePanel" class="source-panel active">
                <div class="upload-zone" id="uploadZone">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    <p>Drag & drop files here or <span class="upload-link">browse</span></p>
                    <span class="upload-hint">Supports: CSV, Excel (.xlsx, .xls)</span>
                    <input type="file" id="fileInput" multiple accept=".csv,.xlsx,.xls" hidden>
                </div>
                <div id="fileList" class="file-list"></div>
                <button id="loadFilesBtn" class="btn btn-primary" disabled>Load Files</button>
            </div>

            <!-- PostgreSQL Panel -->
            <div id="postgresPanel" class="source-panel">
                <div class="connection-form">
                    <!-- Credentials Manager -->
                    <div class="credentials-manager">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="pgSavedCredentials">Load Saved Credentials</label>
                                <div class="input-with-addon">
                                    <select id="pgSavedCredentials" class="form-select">
                                        <option value="">Select saved...</option>
                                    </select>
                                    <button type="button" id="deletePgCredentialsBtn" class="btn btn-danger btn-sm"
                                        title="Delete selected">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            width="14" height="14">
                                            <polyline points="3 6 5 6 21 6"></polyline>
                                            <path
                                                d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2">
                                            </path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="pgCredentialName">Save Current As</label>
                                <div class="input-with-addon">
                                    <input type="text" id="pgCredentialName" placeholder="Credential name...">
                                    <button type="button" id="savePgCredentialsBtn"
                                        class="btn btn-secondary">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pgHost">Host</label>
                            <input type="text" id="pgHost" placeholder="localhost">
                        </div>
                        <div class="form-group">
                            <label for="pgPort">Port</label>
                            <input type="text" id="pgPort" placeholder="5432" value="5432">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pgDatabase">Database</label>
                            <input type="text" id="pgDatabase" placeholder="database_name">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pgUser">Username</label>
                            <input type="text" id="pgUser" placeholder="username">
                        </div>
                        <div class="form-group">
                            <label for="pgPassword">Password</label>
                            <input type="password" id="pgPassword" placeholder="password">
                        </div>
                    </div>
                    <button id="testPgBtn" class="btn btn-outline">Test Connection</button>
                </div>
                <div class="sql-editor-container">
                    <label>SQL Query</label>
                    <textarea id="pgQuery" class="sql-editor"
                        placeholder="SELECT * FROM your_table LIMIT 1000"></textarea>
                </div>
                <button id="runPgQueryBtn" class="btn btn-primary">Run Query</button>
            </div>

            <!-- Athena Panel -->
            <div id="athenaPanel" class="source-panel">
                <div class="connection-form">
                    <!-- Credentials Manager -->
                    <div class="credentials-manager">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="athenaSavedCredentials">Load Saved Credentials</label>
                                <div class="input-with-addon">
                                    <select id="athenaSavedCredentials" class="form-select">
                                        <option value="">Select saved...</option>
                                    </select>
                                    <button type="button" id="deleteAthenaCredentialsBtn" class="btn btn-danger btn-sm"
                                        title="Delete selected">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            width="14" height="14">
                                            <polyline points="3 6 5 6 21 6"></polyline>
                                            <path
                                                d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2">
                                            </path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="athenaCredentialName">Save Current As</label>
                                <div class="input-with-addon">
                                    <input type="text" id="athenaCredentialName" placeholder="Credential name...">
                                    <button type="button" id="saveAthenaCredentialsBtn"
                                        class="btn btn-secondary">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="athenaRegion">AWS Region</label>
                            <input type="text" id="athenaRegion" placeholder="us-east-1" value="us-east-1">
                        </div>
                        <div class="form-group">
                            <label for="athenaWorkgroup">Workgroup</label>
                            <input type="text" id="athenaWorkgroup" placeholder="primary" value="primary">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="athenaDatabase">Database</label>
                            <input type="text" id="athenaDatabase" placeholder="database_name">
                        </div>
                        <div class="form-group">
                            <label for="athenaS3Output">S3 Output Location</label>
                            <input type="text" id="athenaS3Output" placeholder="s3://bucket/path/">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="athenaAccessKey">Access Key (optional)</label>
                            <input type="text" id="athenaAccessKey" placeholder="AWS Access Key">
                        </div>
                        <div class="form-group">
                            <label for="athenaSecretKey">Secret Key (optional)</label>
                            <input type="password" id="athenaSecretKey" placeholder="AWS Secret Key">
                        </div>
                    </div>
                    <button id="testAthenaBtn" class="btn btn-outline">Test Connection</button>
                </div>
                <div class="sql-editor-container">
                    <label>SQL Query</label>
                    <textarea id="athenaQuery" class="sql-editor"
                        placeholder="SELECT * FROM your_table LIMIT 1000"></textarea>
                </div>
                <button id="runAthenaQueryBtn" class="btn btn-primary">Run Query</button>
            </div>

            <!-- Loaded Sources Panel -->
            <div id="loadedSourcesPanel" class="loaded-sources-panel hidden">
                <div class="panel-header">
                    <h3>Loaded Sources <span id="sourceCount">(0)</span></h3>
                    <button id="refreshSourcesBtn" class="btn btn-outline btn-sm">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16"
                            height="16">
                            <polyline points="23 4 23 10 17 10"></polyline>
                            <polyline points="1 20 1 14 7 14"></polyline>
                            <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"></path>
                        </svg>
                    </button>
                </div>
                <div id="sourcesList" class="sources-list"></div>
            </div>
        </section>

        <!-- QC Checks View -->
        <section id="qcView" class="view">
            <div class="view-header">
                <h2>Quality Checks</h2>
                <p>Configure and run QC rules on your loaded data</p>
            </div>

            <div id="noDataMessage" class="message-box">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
                <p>Please load data first before running QC checks</p>
                <button class="btn btn-primary" data-view="data">Go to Data Source</button>
            </div>

            <div id="qcContainer" class="qc-container hidden">
                <!-- Source Selector -->
                <div class="qc-source-selector-wrapper">
                    <div class="form-group">
                        <label for="qcSourceSelect">Select Data Source</label>
                        <select id="qcSourceSelect" class="form-select">
                            <option value="">Select source...</option>
                        </select>
                    </div>
                    <div id="selectedSourceInfo" class="selected-source-info"></div>
                </div>

                <!-- Available Rules -->
                <div class="rules-panel">
                    <h3>Available Rules</h3>
                    <div id="rulesList" class="rules-list"></div>
                </div>

                <!-- Active Rules -->
                <div class="active-rules-panel">
                    <h3>Active Rules <span id="activeRuleCount">(0)</span></h3>
                    <div id="activeRulesList" class="active-rules-list"></div>
                    <button id="runQcBtn" class="btn btn-primary btn-lg" disabled>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="5 3 19 12 5 21 5 3"></polygon>
                        </svg>
                        Run QC Checks
                    </button>
                </div>
            </div>
        </section>

        <!-- Compare View -->
        <section id="compareView" class="view">
            <div class="view-header">
                <h2>Compare Datasets</h2>
                <p>Select multiple data sources to find duplicates, unique records, and differences</p>
            </div>

            <div id="noCompareDataMessage" class="message-box">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
                <p>Load at least 2 data sources to compare</p>
                <button class="btn btn-primary" data-view="data">Go to Data Source</button>
            </div>

            <div id="compareContainer" class="compare-enhanced hidden">
                <!-- Source Selection -->
                <div class="compare-section">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20"
                            height="20">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                        Select Sources to Compare
                    </h3>
                    <p class="section-hint">Select 2 or more sources to compare</p>
                    <div id="compareSourcesList" class="compare-sources-grid"></div>
                </div>

                <!-- Column Selection -->
                <div class="compare-section">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20"
                            height="20">
                            <line x1="8" y1="6" x2="21" y2="6"></line>
                            <line x1="8" y1="12" x2="21" y2="12"></line>
                            <line x1="8" y1="18" x2="21" y2="18"></line>
                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                        </svg>
                        Column Configuration
                    </h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="compareKeyColumns">Key Columns (for matching rows)</label>
                            <select id="compareKeyColumns" class="form-select multi-select" multiple>
                            </select>
                            <small class="form-hint">Hold Ctrl/Cmd to select multiple. These columns identify unique
                                rows.</small>
                        </div>
                        <div class="form-group">
                            <label for="compareValueColumns">Columns to Compare (optional)</label>
                            <select id="compareValueColumns" class="form-select multi-select" multiple>
                            </select>
                            <small class="form-hint">Leave empty to compare all columns.</small>
                        </div>
                    </div>

                    <!-- JOIN Type -->
                    <div class="form-row" style="margin-top: 1rem;">
                        <div class="form-group">
                            <label for="compareJoinType">Join Type</label>
                            <select id="compareJoinType" class="form-select">
                                <option value="full">FULL OUTER (all rows from all sources)</option>
                                <option value="inner">INNER (only matching rows)</option>
                                <option value="left">LEFT (all from first source)</option>
                                <option value="right">RIGHT (all from second source)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Column Mapping (Optional) -->
                <div class="compare-section">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20"
                            height="20">
                            <path d="M16 3h5v5"></path>
                            <line x1="21" y1="3" x2="14" y2="10"></line>
                            <path d="M8 21H3v-5"></path>
                            <line x1="3" y1="21" x2="10" y2="14"></line>
                        </svg>
                        Column Mapping <span class="badge-optional">Optional</span>
                    </h3>
                    <p class="section-hint">Map columns if they have different names across sources</p>
                    <div id="columnMappingList" class="column-mapping-list"></div>
                    <button type="button" id="addColumnMapping" class="btn btn-sm btn-secondary">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16"
                            height="16">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Add Column Mapping
                    </button>
                </div>

                <!-- Analysis Options -->
                <div class="compare-section">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20"
                            height="20">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                        </svg>
                        Analysis Options
                    </h3>
                    <div class="analysis-options">
                        <label class="analysis-option">
                            <input type="checkbox" id="showDuplicates" checked>
                            <span class="option-icon duplicate">üîÑ</span>
                            <span class="option-text">
                                <strong>Duplicates</strong>
                                <small>Rows appearing in multiple sources</small>
                            </span>
                        </label>
                        <label class="analysis-option">
                            <input type="checkbox" id="showUnique" checked>
                            <span class="option-icon unique">üîπ</span>
                            <span class="option-text">
                                <strong>Unique</strong>
                                <small>Rows only in one source</small>
                            </span>
                        </label>
                        <label class="analysis-option">
                            <input type="checkbox" id="showNotMatched" checked>
                            <span class="option-icon notmatched">‚ùå</span>
                            <span class="option-text">
                                <strong>Value Differences</strong>
                                <small>Matched keys with different values</small>
                            </span>
                        </label>
                    </div>

                    <!-- Tolerance Settings -->
                    <h4 class="subsection-title">Tolerance Settings</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="compareTolerance">Numeric Tolerance</label>
                            <div class="input-with-addon">
                                <input type="number" id="compareTolerance" value="0" step="0.01" min="0"
                                    placeholder="0">
                                <select id="compareToleranceType" class="form-select-sm">
                                    <option value="absolute">Absolute</option>
                                    <option value="percent">Percent %</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="compareDateTolerance">Date Tolerance</label>
                            <div class="input-with-addon">
                                <input type="number" id="compareDateTolerance" value="0" step="1" min="0"
                                    placeholder="0">
                                <select id="compareDateToleranceUnit" class="form-select-sm">
                                    <option value="days">Days</option>
                                    <option value="hours">Hours</option>
                                    <option value="minutes">Minutes</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Comparison Options -->
                    <h4 class="subsection-title">String & Null Handling</h4>
                    <div class="form-row checkbox-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="compareIgnoreCase"> Ignore Case
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="compareIgnoreWhitespace"> Ignore Whitespace
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="compareNullEqualsNull" checked> Null = Null is Match
                        </label>
                    </div>
                </div>

                <!-- Aggregation QC Section -->
                <div class="compare-section">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20"
                            height="20">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="3" y1="9" x2="21" y2="9"></line>
                            <line x1="9" y1="21" x2="9" y2="9"></line>
                        </svg>
                        Aggregation QC <span class="badge-optional">Optional</span>
                    </h3>
                    <p class="section-hint">Compare totals like SUM, COUNT, AVG between sources</p>

                    <label class="checkbox-label" style="margin-bottom: 1rem;">
                        <input type="checkbox" id="enableAggregation"> Enable Aggregation Comparison
                    </label>

                    <div id="aggregationOptions" class="aggregation-options hidden">
                        <div class="form-row" style="margin-bottom: 1rem;">
                            <div class="form-group">
                                <label for="aggGroupBy">Group By Columns</label>
                                <select id="aggGroupBy" class="form-select multi-select" multiple>
                                </select>
                                <small class="form-hint">Select columns to group by (e.g., date, category)</small>
                            </div>
                        </div>

                        <p class="section-hint" style="margin-bottom: 0.5rem;">Add columns to aggregate:</p>
                        <div id="aggregationList" class="aggregation-list">
                            <!-- Dynamic rows will be added here -->
                        </div>
                        <button type="button" id="addAggregationBtn" class="btn btn-sm btn-secondary"
                            style="margin-top: 0.5rem;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14"
                                height="14">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            Add Aggregation
                        </button>
                    </div>
                </div>

                <!-- Advanced Options Section -->
                <div class="compare-section">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20"
                            height="20">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path
                                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                            </path>
                        </svg>
                        Advanced Options <span class="badge-optional">Optional</span>
                    </h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Fuzzy String Matching</label>
                            <div class="input-with-addon">
                                <label class="checkbox-label" style="margin: 0;">
                                    <input type="checkbox" id="enableFuzzyMatch"> Enable Fuzzy Match
                                </label>
                                <input type="number" id="fuzzyThreshold" value="80" min="0" max="100" step="5"
                                    placeholder="80" style="width: 80px;" title="Similarity % (0-100)">
                            </div>
                            <small class="form-hint">Match strings with similar spelling (threshold: 80 = 80%
                                similar)</small>
                        </div>
                        <div class="form-group">
                            <label for="transformations">Apply Transformations</label>
                            <select id="transformations" class="form-select multi-select" multiple>
                                <option value="trim">Trim whitespace</option>
                                <option value="lower">Lowercase</option>
                                <option value="upper">Uppercase</option>
                                <option value="remove_special">Remove special chars</option>
                                <option value="normalize_spaces">Normalize spaces</option>
                            </select>
                            <small class="form-hint">Transform values before comparing</small>
                        </div>
                    </div>
                </div>

                <!-- Template Section -->
                <div class="compare-section template-section">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20"
                            height="20">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                            <polyline points="7 3 7 8 15 8"></polyline>
                        </svg>
                        QC Templates <span class="badge-optional">Optional</span>
                    </h3>
                    <div class="template-actions">
                        <div class="form-group">
                            <label for="loadTemplate">Load Template</label>
                            <select id="loadTemplate" class="form-select">
                                <option value="">Select saved template...</option>
                            </select>
                        </div>
                        <div class="form-group template-save">
                            <label for="templateName">Save Current Config</label>
                            <div class="input-with-addon">
                                <input type="text" id="templateName" placeholder="Template name...">
                                <button type="button" id="saveTemplateBtn" class="btn btn-secondary">Save</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Formula Calculation Section -->
                <div class="compare-section">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20"
                            height="20">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Formula Calculator <span class="badge-optional">Optional</span>
                    </h3>
                    <p class="section-hint">Calculate values between columns from different sources (e.g.,
                        Source1.Amount - Source2.Amount)</p>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="formulaSource1">Source 1</label>
                            <select id="formulaSource1" class="form-select">
                                <option value="">Select source...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="formulaColumn1">Column</label>
                            <select id="formulaColumn1" class="form-select">
                                <option value="">Select column...</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row" style="align-items: center;">
                        <div class="form-group" style="flex: 0 0 100px;">
                            <label for="formulaOperation">Operation</label>
                            <select id="formulaOperation" class="form-select">
                                <option value="-">‚àí Subtract</option>
                                <option value="+">+ Add</option>
                                <option value="*">√ó Multiply</option>
                                <option value="/">√∑ Divide</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="formulaSource2">Source 2</label>
                            <select id="formulaSource2" class="form-select">
                                <option value="">Select source...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="formulaColumn2">Column</label>
                            <select id="formulaColumn2" class="form-select">
                                <option value="">Select column...</option>
                            </select>
                        </div>
                    </div>

                    <h4 class="subsection-title">Row Matching</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="formulaMatchBy">Match Rows By</label>
                            <select id="formulaMatchBy" class="form-select">
                                <option value="index">Index (row position)</option>
                                <option value="key">Key Column(s)</option>
                            </select>
                        </div>
                        <div class="form-group" id="formulaKeyColumnGroup" style="display: none;">
                            <label for="formulaKeyColumns">Key Column(s)</label>
                            <select id="formulaKeyColumns" class="form-select multi-select" multiple>
                            </select>
                            <small class="form-hint">Select column(s) to match rows between sources</small>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="formulaResultName">Result Column Name</label>
                            <input type="text" id="formulaResultName" value="Calculated"
                                placeholder="Result column name">
                        </div>
                    </div>

                    <button id="runFormulaBtn" class="btn btn-secondary">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16"
                            height="16">
                            <polyline points="16 18 22 12 16 6"></polyline>
                            <polyline points="8 6 2 12 8 18"></polyline>
                        </svg>
                        Calculate Formula
                    </button>
                </div>

                <button id="runCompareBtn" class="btn btn-primary btn-lg" disabled>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    Compare Selected Sources
                </button>
            </div>
        </section>

        <!-- Results View -->
        <section id="resultsView" class="view">
            <div class="view-header">
                <h2>Results</h2>
                <p>View QC check and comparison results</p>
            </div>

            <div id="noResultsMessage" class="message-box">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="3" y1="9" x2="21" y2="9"></line>
                    <line x1="9" y1="21" x2="9" y2="9"></line>
                </svg>
                <p>No results yet. Run QC checks or compare datasets.</p>
            </div>

            <div id="resultsContainer" class="results-container hidden">
                <!-- Results Summary -->
                <div id="resultsSummary" class="results-summary"></div>

                <!-- Detailed Results -->
                <div id="resultsDetail" class="results-detail"></div>
            </div>
        </section>
    </main>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-spinner"></div>
        <p id="loadingMessage">Loading...</p>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Export Modal -->
    <div id="exportModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Export Results</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Export Format</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="exportFormat" value="csv" checked> CSV
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="exportFormat" value="excel"> Excel
                        </label>
                    </div>
                </div>
                <label class="checkbox-label">
                    <input type="checkbox" id="includeFailedRows" checked> Include Failed Rows
                </label>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline modal-cancel">Cancel</button>
                <button id="confirmExportBtn" class="btn btn-primary">Export</button>
            </div>
        </div>
    </div>

    <!-- Rename Source Modal -->
    <div id="renameSourceModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Rename Source</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="newSourceName">New Name</label>
                    <input type="text" id="newSourceName" placeholder="Enter new name...">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline modal-cancel">Cancel</button>
                <button id="confirmRenameBtn" class="btn btn-primary">Rename</button>
            </div>
        </div>
    </div>

    <!-- SQL Query Modal -->
    <div id="sqlQueryModal" class="modal hidden">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h3>SQL Query - <span id="sqlQuerySourceName"></span></h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="sql-query-display">
                    <pre id="sqlQueryContent" class="sql-code"></pre>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline modal-cancel">Close</button>
                <button class="btn btn-primary" onclick="DataSource.copySqlQuery()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                        <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                    </svg>
                    Copy SQL
                </button>
            </div>
        </div>
    </div>

    <!-- Rule Config Modal -->
    <div id="ruleConfigModal" class="modal hidden">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h3 id="ruleConfigTitle">Configure Rule</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="ruleConfigBody"></div>
            <div class="modal-footer">
                <button class="btn btn-outline modal-cancel">Cancel</button>
                <button id="addRuleBtn" class="btn btn-primary">Add Rule</button>
            </div>
        </div>
    </div>

    <!-- Data Viewer Modal -->
    <div id="dataViewerModal" class="modal hidden">
        <div class="modal-content modal-fullscreen">
            <div class="modal-header">
                <div class="modal-title-group">
                    <h3 id="dataViewerTitle">Data Viewer</h3>
                    <span id="dataViewerInfo" class="modal-subtitle"></span>
                </div>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-toolbar">
                <div class="toolbar-left">
                    <input type="text" id="dataSearchInput" class="form-input" placeholder="Search...">
                </div>
                <div class="toolbar-right">
                    <label>Rows per page:</label>
                    <select id="pageSizeSelect" class="form-select-sm">
                        <option value="25">25</option>
                        <option value="50" selected>50</option>
                        <option value="100">100</option>
                        <option value="250">250</option>
                    </select>
                </div>
            </div>
            <div class="modal-body modal-body-table">
                <div class="table-container-full">
                    <table id="dataViewerTable" class="data-table">
                        <thead id="dataViewerHead"></thead>
                        <tbody id="dataViewerBody"></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer modal-footer-pagination">
                <div class="pagination-info">
                    <span id="paginationInfo">Showing 0-0 of 0</span>
                </div>
                <div class="pagination-controls">
                    <button id="prevPageBtn" class="btn btn-outline btn-sm" disabled>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16"
                            height="16">
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                        Previous
                    </button>
                    <span id="pageIndicator" class="page-indicator">Page 1 of 1</span>
                    <button id="nextPageBtn" class="btn btn-outline btn-sm">
                        Next
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16"
                            height="16">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/static/js/app.js"></script>
    <script src="/static/js/dataSource.js"></script>
    <script src="/static/js/qcRules.js"></script>
    <script src="/static/js/results.js"></script>
</body>

</html>